%% LaTeX-Beamer template for ICube Unistra design
%% par Laurent Barbé
%% inspiré de Erik Burger, Christian Hammer pour le KIT
%% version 2.0
%%

\usepackage{templates/beamerthemeICubebase}
\usepackage{lastpage}

\setbeamertemplate{title page}
{
\thispagestyle{empty}

%middle block with name of institute
\begin{textblock*}{\paperwidth}(1mm,42mm)
\begin{pgfpicture}{0mm}{0mm}{\paperwidth-2mm}{6mm}
	\color{black!50}
	\pgfpathrectangle{\pgfpoint{0mm}{0mm}}{\pgfpoint{\paperwidth-2mm}{6mm}}
	\pgfusepath{fill}
	\pgftext[at=\pgfpoint{5mm}{3mm},left,center]{\textcolor{white}{\tiny\uppercase\expandafter{\insertinstitute}}}
\end{pgfpicture}
\end{textblock*}


%elements on title page

%ICube logo
\begin{textblock*}{24mm}(6mm,5mm)
\iflanguage{english}{%
\includegraphics[width=23mm]{logos/icube/icube-png.png} 
}{%
\includegraphics[width=23mm]{logos/icube/icube-png.png}
}%
\end{textblock*}

%funding logo
%\begin{textblock*}{13mm}(129,5mm)
%\includegraphics[width=13mm]{logos/\@titlefundinglogo} 
%\end{textblock*}

%institute logo
\begin{textblock*}{\textwidth}(80mm,5mm)
%	\begin{textblock*}{39mm}(116mm,5mm)
\includegraphics[height=8mm]{logos/\@titlelogoe}%
\includegraphics[height=8mm]{logos/\@titlelogod}%
\includegraphics[height=8mm]{logos/\@titlelogoc}%
\includegraphics[height=8mm]{logos/\@titlelogob}%
\includegraphics[height=8mm]{logos/\@titlelogoa} 
\end{textblock*}

%title
\begin{textblock*}{120mm}(6mm,16mm)
\begin{beamercolorbox}[wd=118mm,ht=14mm,dp=3mm,left]{white}%
	\color{white!15}
	\Large\textbf{\inserttitle}
\end{beamercolorbox}
\end{textblock*}

%subtitle
\begin{textblock*}{120mm}(6mm,33mm)
\scriptsize \insertsubtitle
\end{textblock*}

%author
\begin{textblock*}{120mm}(6mm,37mm)
\scriptsize\insertauthor~\textbar~\insertshortdate
\end{textblock*}

%legal Unistra Text
\begin{textblock*}{80mm}[0,1](6mm,88.5mm)
\fontsize{4pt}{6pt}\selectfont
\iflanguage{english}{
Legal text ICube Unistra}
{texte légal ICube Unistra}
\end{textblock*}

\begin{textblock*}{16mm}(130mm,87.mm)
\fontsize{8pt}{8pt}\selectfont
\bfseries
\textcolor{white}{
	\href{https://icube.unistra.fr/}{icube.unistra.fr/}
}
\end{textblock*}

% title image

\begin{textblock*}{\paperwidth}(1.1mm,25.1mm)
\begin{overpic}[width=157.8mm]{logos/\@titleimage} %height =38mm
\put(-6,-3){
	%mask curve for lower left corner of title image
	\begin{pgfpicture}{0mm}{0mm}{3mm}{3mm}
		\pgfpathqmoveto{0mm}{0mm}
		\pgfpathlineto{\pgfpoint{3mm}{0mm}}
		\pgfpathlineto{\pgfpoint{3mm}{1mm}}

		{\pgfsetcornersarced{\pgfpoint{2mm}{2mm}} 
		\pgfpathlineto{\pgfpoint{1mm}{1mm}}
		\pgfpathlineto{\pgfpoint{1mm}{3mm}}}

		\pgfpathmoveto{\pgfpoint{1mm}{3mm}}
		\pgfpathlineto{\pgfpoint{0mm}{3mm}}
		\pgfpathlineto{\pgfpoint{0mm}{0mm}}
		\pgfpathclose

		\color{black!15}
		\pgfusepath{fill}
	\end{pgfpicture}
}
\end{overpic}
\end{textblock*}

}

%background for pages
%CH: for plain frames
\newlength{\kitbottom}
\usebackgroundtemplate{
	\setlength{\kitbottom}{\ifbeamer@plainframe1mm\else4mm\fi}%
\begin{pgfpicture}{0mm}{0mm}{\paperwidth}{\paperheight}

	{\pgfsetcornersarced{\pgfpoint{2mm}{2mm}}
	\pgfpathmoveto{\pgfpoint{\paperwidth-1mm}{\kitbottom}}
	\pgfpathlineto{\pgfpoint{1mm}{\kitbottom}}
	\pgfpathlineto{\pgfpoint{1mm}{\paperheight-1mm}}}

	{\pgfsetcornersarced{\pgfpoint{2mm}{2mm}}
	\pgfpathmoveto{\pgfpoint{1mm}{\paperheight-1mm}}
	\pgfpathlineto{\pgfpoint{\paperwidth-1mm}{\paperheight-1mm}}
	\pgfpathlineto{\pgfpoint{\paperwidth-1mm}{\kitbottom}}}

	\color{white}
	\pgfusepath{fill}

\end{pgfpicture}%
}

%frametitle
\setbeamertemplate{frametitle}
{
\vspace{2mm} %\hspace*{-4mm}
%\vbox{\hsize=9cm\bfseries\insertframetitle}
\vbox{\hsize=12cm\bfseries\insertframetitle}

\begin{textblock*}{15mm}(142mm,4mm)
\iflanguage{english}{%
\includegraphics[width=14mm]{logos/icube/icube-png.png} 
}{%
\includegraphics[width=14mm]{logos/icube/icube-png.png} 
}%
\end{textblock*}
}


\setbeamertemplate{headline}
{
}

%footer
\setbeamertemplate{footline}
{
\vskip.4mm
\begin{beamercolorbox}[leftskip=.5em,ht=1mm,dp=1.3mm]{section in head/foot}
  \hspace{1.3em}\usebeamerfont{author in head/foot}%
  \insertshorttitle \hspace*{1mm} - \hspace*{1mm} \insertshortauthor
  \hfill\insertshortdate\hspace{30pt}\insertframenumber{}/\inserttotalframenumber\hspace{4mm}
\end{beamercolorbox}
}

\newcommand{\backupbegin}{
   \newcounter{finalframe}
   \setcounter{finalframe}{\value{framenumber}}
}
\newcommand{\backupend}{
   \setcounter{framenumber}{\value{finalframe}}
}
